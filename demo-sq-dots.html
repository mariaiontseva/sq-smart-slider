<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SQ Dots — 8 6 4 2</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #1c1c1e;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
    color: #fff;
    gap: 24px;
    padding: 20px;
  }

  h2 { font-size: 15px; font-weight: 600; color: #8e8e93; letter-spacing: 0.5px; }

  .selector-bar {
    display: flex; align-items: center; gap: 8px;
    background: #2c2c2e; padding: 8px 16px; border-radius: 16px;
  }
  .selector-label { font-size: 13px; font-weight: 600; color: #8e8e93; margin-right: 4px; }
  .selector-btn {
    width: 40px; height: 36px; border-radius: 10px; border: none;
    background: #3a3a3c; color: #fff; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; font-family: inherit;
  }
  .selector-btn:hover { background: #48484a; }
  .selector-btn.active { background: #4075BF; }

  .phone-frame {
    width: 375px;
    background: #000;
    border-radius: 44px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 0 2px #3a3a3c, 0 40px 100px rgba(0,0,0,0.4);
  }

  .image-carousel {
    width: 100%;
    height: 420px;
    position: relative;
    overflow: hidden;
    background: #2c2c2e;
  }

  .image-track {
    display: flex;
    height: 100%;
    transition: transform 0.45s cubic-bezier(0.25, 0.1, 0.25, 1);
    will-change: transform;
  }
  .image-track.dragging { transition: none; }

  .image-slide {
    min-width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    user-select: none;
    -webkit-user-select: none;
  }

  .arrow-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 36px; height: 36px;
    border-radius: 50%;
    background: rgba(0,0,0,0.35);
    backdrop-filter: blur(12px);
    border: none; color: #fff;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; z-index: 15;
    transition: opacity 0.25s, background 0.2s;
  }
  .arrow-btn:hover { background: rgba(0,0,0,0.55); }
  .arrow-btn:active { transform: translateY(-50%) scale(0.92); }
  .arrow-btn.hidden { opacity: 0; pointer-events: none; }
  .arrow-left { left: 12px; }
  .arrow-right { right: 12px; }
  .arrow-btn svg { width: 18px; height: 18px; stroke: #fff; stroke-width: 2.2; fill: none; stroke-linecap: round; stroke-linejoin: round; }

  .counter-badge {
    position: absolute;
    top: 16px; right: 16px;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(12px);
    color: #fff; font-size: 13px; font-weight: 500;
    padding: 4px 10px; border-radius: 12px;
    font-variant-numeric: tabular-nums; z-index: 10;
  }

  .dots-container {
    position: absolute;
    bottom: 16px; left: 50%;
    transform: translateX(-50%);
    display: flex; align-items: center; gap: 5px; height: 10px;
    z-index: 10;
  }

  .demo-box {
    background: #2c2c2e; border-radius: 20px; padding: 20px 40px;
    display: flex; flex-direction: column; align-items: center; gap: 12px;
    min-width: 400px;
  }

  .dots-row {
    display: flex; align-items: center; gap: 5px; height: 12px;
  }

  .dot {
    border-radius: 50%;
    transition: all 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
    will-change: width, height;
    flex-shrink: 0;
    cursor: pointer;
  }

  .counter { font-size: 14px; color: #8e8e93; font-variant-numeric: tabular-nums; }

  .arrows {
    display: flex; gap: 12px; align-items: center;
  }
  .arrow {
    width: 40px; height: 40px; border-radius: 50%; border: none;
    background: #3a3a3c; color: #fff; font-size: 18px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: background 0.2s;
  }
  .arrow:hover { background: #48484a; }
  .arrow:disabled { opacity: 0.3; cursor: default; }

  .spec-table {
    font-size: 12px; color: #aeaeb2; line-height: 1.8;
    text-align: center;
  }
  .spec-table .blue { color: #4075BF; font-weight: 600; }
  .spec-table .white { color: #fff; font-weight: 600; }

  .nav-hint { font-size: 11px; color: #636366; }
  .nav-hint kbd {
    background: #3a3a3c; border: 1px solid #48484a; border-radius: 4px;
    padding: 1px 6px; font-family: inherit; font-size: 10px; color: #8e8e93;
  }
</style>
</head>
<body>

<h2>SQ SMART DOTS — 8 / 6 / 4 / 2 px</h2>

<div class="selector-bar">
  <span class="selector-label">Slides:</span>
  <button class="selector-btn" data-count="3">3</button>
  <button class="selector-btn" data-count="5">5</button>
  <button class="selector-btn" data-count="7">7</button>
  <button class="selector-btn" data-count="8">8</button>
  <button class="selector-btn" data-count="9">9</button>
  <button class="selector-btn" data-count="10">10</button>
  <button class="selector-btn active" data-count="20">20</button>
  <button class="selector-btn" data-count="50">50</button>
  <button class="selector-btn" data-count="100">100</button>
</div>

<div class="phone-frame">
  <div class="image-carousel" id="viewport">
    <div class="image-track" id="track"></div>
    <button class="arrow-btn arrow-left hidden" id="arrowLeft">
      <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
    </button>
    <button class="arrow-btn arrow-right" id="arrowRight">
      <svg viewBox="0 0 24 24"><polyline points="9 6 15 12 9 18"/></svg>
    </button>
    <div class="counter-badge" id="counter">1/20</div>
    <div class="dots-container" id="dots"></div>
  </div>
</div>

<div class="demo-box">
  <div class="spec-table" id="spec"></div>
</div>

<div class="nav-hint"><kbd>←</kbd> <kbd>→</kbd> arrows or swipe</div>

<script>
// SQ sizes: 8 → 8 → 6 → 4 → 2 → 0
// distance:  0    1    2    3    4   5+
const SIZES = [8, 8, 6, 4];
const ACTIVE_COLOUR = '#4075BF';
const DEFAULT_COLOUR = 'rgba(255,255,255,0.7)';
const MAX_VISIBLE = 7; // active + 3 on each side

let total = 20;
let current = 0;
let dots = [];

const track = document.getElementById('track');
const dotsEl = document.getElementById('dots');
const counterEl = document.getElementById('counter');
const specEl = document.getElementById('spec');
const arrowLeft = document.getElementById('arrowLeft');
const arrowRight = document.getElementById('arrowRight');
const viewport = document.getElementById('viewport');

function dotSize(distance) {
  if (distance < SIZES.length) return SIZES[distance];
  return 0;
}

function build(count) {
  total = count;
  current = 0;
  track.innerHTML = '';
  dotsEl.innerHTML = '';
  dots = [];

  for (let i = 0; i < count; i++) {
    const slide = document.createElement('div');
    slide.className = 'image-slide';
    slide.style.backgroundImage = `url(https://picsum.photos/seed/sq${i + 1}/750/840)`;
    const hue = (i * (360 / count)) % 360;
    slide.style.backgroundColor = `hsl(${hue}, 30%, 45%)`;
    track.appendChild(slide);
  }

  for (let i = 0; i < count; i++) {
    const dot = document.createElement('div');
    dot.className = 'dot';
    dot.addEventListener('click', () => goTo(i));
    dotsEl.appendChild(dot);
    dots.push(dot);
  }
  goTo(0);
}

function update(page) {
  track.style.transform = `translateX(-${page * 100}%)`;

  let specLines = [];

  dots.forEach((dot, i) => {
    const distance = Math.abs(i - page);
    let sz;

    if (total <= 7) {
      sz = 8;
    } else {
      sz = dotSize(distance);
    }

    const isActive = (i === page);
    dot.style.width = sz + 'px';
    dot.style.height = sz + 'px';
    dot.style.backgroundColor = isActive ? ACTIVE_COLOUR : DEFAULT_COLOUR;
    dot.style.margin = sz === 0 ? '0 -2.5px' : '0';
    dot.style.opacity = sz === 0 ? '0' : '1';

    if (sz > 0 && total > 7) {
      specLines.push(
        `${isActive ? '<span class="blue">●</span>' : '○'} #${i+1}: ${sz}px`
      );
    }
  });

  counterEl.textContent = `${page + 1}/${total}`;
  arrowLeft.classList.toggle('hidden', page === 0);
  arrowRight.classList.toggle('hidden', page === total - 1);

  if (total <= 7) {
    specEl.innerHTML = `<span class="white">Simple mode</span> — all ${total} dots at 8px, no scaling`;
  } else {
    specEl.innerHTML = `<span class="white">Sizes:</span> 8px → 8px → 6px → 4px → hidden<br>` +
      `<span class="white">Dist:</span> 0 (active) · 1 (neighbour) · 2 · 3 · 4+<br>` +
      `<span class="white">Max visible:</span> ${MAX_VISIBLE} · <span class="white">Gap:</span> 5px · <span class="white">Active:</span> 100% · <span class="white">Inactive:</span> 70% opacity<br>` +
      specLines.join(' · ') +
      `<br><br><span class="white">— Transition & Animation —</span><br>` +
      `<span class="white">Dots:</span> all 0.4s cubic-bezier(0.25, 0.1, 0.25, 1) · will-change: width, height<br>` +
      `<span class="white">Slide:</span> transform 0.45s cubic-bezier(0.25, 0.1, 0.25, 1) · will-change: transform<br>` +
      `<span class="white">Drag:</span> transition: none (during drag) · snap threshold: 18% of slide width<br>` +
      `<span class="white">Arrows:</span> opacity 0.25s · scale 0.92 on press<br>` +
      `<span class="white">Easing:</span> cubic-bezier(0.25, 0.1, 0.25, 1) — CSS ease equivalent`;
  }
}

function goTo(page) {
  if (page < 0 || page >= total) return;
  current = page;
  update(current);
}

// Arrows
arrowLeft.addEventListener('click', e => { e.stopPropagation(); goTo(current - 1); });
arrowRight.addEventListener('click', e => { e.stopPropagation(); goTo(current + 1); });

// Keyboard
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowRight') goTo(current + 1);
  if (e.key === 'ArrowLeft') goTo(current - 1);
});

// Touch / mouse swipe
let startX = 0, isDragging = false, dragOffset = 0;
const slideWidth = () => viewport.offsetWidth;

function onDown(e) {
  if (e.target.closest('.arrow-btn')) return;
  isDragging = true;
  startX = (e.clientX !== undefined) ? e.clientX : e.touches[0].clientX;
  dragOffset = 0;
  track.classList.add('dragging');
}
function onMove(e) {
  if (!isDragging) return;
  const x = (e.clientX !== undefined) ? e.clientX : e.touches[0].clientX;
  dragOffset = x - startX;
  track.style.transform = `translateX(${-current * slideWidth() + dragOffset}px)`;
}
function onUp() {
  if (!isDragging) return;
  isDragging = false;
  track.classList.remove('dragging');
  const threshold = slideWidth() * 0.18;
  if (dragOffset < -threshold) goTo(current + 1);
  else if (dragOffset > threshold) goTo(current - 1);
  else goTo(current);
}

viewport.addEventListener('mousedown', onDown);
window.addEventListener('mousemove', onMove);
window.addEventListener('mouseup', onUp);
viewport.addEventListener('touchstart', onDown, { passive: true });
viewport.addEventListener('touchmove', onMove, { passive: true });
viewport.addEventListener('touchend', onUp);

// Selector
document.querySelectorAll('.selector-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.selector-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    build(parseInt(btn.dataset.count));
  });
});

build(20);
</script>
</body>
</html>
